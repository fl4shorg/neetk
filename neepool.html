<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ùó°ùóñùóΩùóó</title>
    <link rel="icon" href="logo.jpg" type="image/jpeg">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/sweetalert/2.1.2/sweetalert.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
    <style>
        body { font-family: Arial, sans-serif; margin: 0; padding: 0; }
        .navbar { display: flex; justify-content: center; align-items: center; background: linear-gradient(to right, #800080, #ff69b4); padding: 10px 20px; color: white; }
        .content { padding: 20px; text-align: center; }
        .card { width: 300px; margin: 16px auto; padding: 10px; border: 1px solid #ccc; border-radius: 8px; background-color: #f9f9f9; box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1); }
        button { padding: 10px 20px; background-color: #333; color: white; border: none; border-radius: 5px; cursor: pointer; }
        button:hover { background-color: #555; }
        .info-card { display: flex; flex-wrap: wrap; justify-content: space-between; margin: 20px; padding: 20px; background-color: #ecf0f1; border-radius: 10px; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1); }
        .info-item { display: flex; align-items: center; margin-bottom: 10px; width: 45%; }
        .info-item i { margin-right: 10px; font-size: 24px; }
        .info-title { font-weight: bold; margin-right: 5px; }
        .info-value { font-size: 16px; }
    </style>
    <script>
        async function fetchData() {
            const response = await fetch("https://script.google.com/macros/s/AKfycbwMkU80r3XS-ECU-ULiz0AjtUwpLmEedtHTkGH0uxiF7lIgvAc1PSymUbSoxQxeDDxCWw/exec");
            const data = await response.text();
            const lines = data.trim().split("\n").slice(1);
            const container = document.getElementById("data");
            container.innerHTML = "";

            lines.forEach((line, index) => {
                const [id, name, age, number, instagram, email] = line.split(", ");
                const card = document.createElement("div");
                card.className = "card";
                card.innerHTML = `
                    <h3>${name}</h3>
                    <p>ID: ${id}</p>
                    <p>Idade: ${age}</p>
                    <p>N√∫mero: ${number}</p>
                    <p>Instagram: ${instagram}</p>
                    <p>Email: ${email}</p>
                    <button onclick="confirmEdit(${index + 2}, '${id}', '${name}', '${age}', '${number}', '${instagram}', '${email}')">Editar</button>
                    <button onclick="deleteData(${index + 2}, '${name}')">Apagar</button>
                `;
                container.appendChild(card);
            });
        }

        async function confirmEdit(row, id, name, age, number, instagram, email) {
            swal({
                title: "Editar Dados",
                content: {
                    element: "div",
                    attributes: {
                        innerHTML: `
                            <input type="number" id="id" value="${id}" readonly>
                            <input type="text" id="name" value="${name}">
                            <input type="number" id="age" value="${age}">
                            <input type="text" id="number" value="${number}">
                            <input type="text" id="instagram" value="${instagram}">
                            <input type="email" id="email" value="${email}">
                        `,
                    },
                },
                buttons: { cancel: "Cancelar", confirm: "Atualizar" },
            }).then(async (value) => {
                if (value) {
                    const name = document.getElementById("name").value;
                    const age = document.getElementById("age").value;
                    const number = document.getElementById("number").value;
                    const instagram = document.getElementById("instagram").value;
                    const email = document.getElementById("email").value;

                    if (!name || !age || !number || !email) {
                        swal("Erro!", "Todos os campos obrigat√≥rios devem ser preenchidos!", "error");
                        return;
                    }

                    await fetch("https://script.google.com/macros/s/AKfycbxa7YkQqTmXv0Qhztgu_ZVUkad2tC3OCZEbqS-Ss3sNChRLvXp-PsCKs0tPOhqE-C102g/exec", {
                        method: "POST",
                        headers: { "Content-Type": "application/x-www-form-urlencoded" },
                        body: new URLSearchParams({ action: "edit", row, id, name, age, number, instagram, email })
                    });

                    swal("Sucesso!", "Dados atualizados com sucesso!", "success");
                    fetchData();
                }
            });
        }

        async function deleteData(row, name) {
            swal({
                title: "Voc√™ tem certeza?",
                text: `Deseja realmente apagar ${name}?`,
                icon: "warning",
                buttons: true,
                dangerMode: true,
            }).then(async (willDelete) => {
                if (willDelete) {
                    await fetch("https://script.google.com/macros/s/AKfycbxa7YkQqTmXv0Qhztgu_ZVUkad2tC3OCZEbqS-Ss3sNChRLvXp-PsCKs0tPOhqE-C102g/exec", {
                        method: "POST",
                        headers: { "Content-Type": "application/x-www-form-urlencoded" },
                        body: new URLSearchParams({ action: "delete", row })
                    });
                    fetchData();
                    swal("Apagado!", "Usu√°rio apagado com sucesso!", "success");
                }
            });
        }

        // Fun√ß√£o para abrir o popup de envio de dados
        function openSendDataPopup() {
            swal({
                title: "Enviar Dados",
                content: {
                    element: "div",
                    attributes: {
                        innerHTML: `
                            <input type="text" id="sendName" placeholder="Nome">
                            <input type="number" id="sendAge" placeholder="Idade">
                            <input type="text" id="sendNumber" placeholder="N√∫mero">
                            <input type="text" id="sendInstagram" placeholder="Instagram">
                            <input type="email" id="sendEmail" placeholder="Email">
                        `,
                    },
                },
                buttons: { cancel: "Cancelar", confirm: "Enviar" },
            }).then(async (value) => {
                if (value) {
                    const name = document.getElementById("sendName").value;
                    const age = document.getElementById("sendAge").value;
                    const number = document.getElementById("sendNumber").value;
                    const instagram = document.getElementById("sendInstagram").value;
                    const email = document.getElementById("sendEmail").value;

                    if (!name || !age || !number || !email) {
                        swal("Erro!", "Todos os campos obrigat√≥rios devem ser preenchidos!", "error");
                        return;
                    }

                    await fetch("https://script.google.com/macros/s/AKfycbxa7YkQqTmXv0Qhztgu_ZVUkad2tC3OCZEbqS-Ss3sNChRLvXp-PsCKs0tPOhqE-C102g/exec", {
                        method: "POST",
                        headers: { "Content-Type": "application/x-www-form-urlencoded" },
                        body: new URLSearchParams({ action: "add", name, age, number, instagram, email })
                    });

                    swal("Sucesso!", "Dados enviados com sucesso!", "success");
                    fetchData();
                }
            });
        }

        window.onload = fetchData;
    </script>
</head>
<body>
    <div class="navbar"><h1>SISTEMA NCPD</h1></div>
    <div class="content">
        <input type="text" id="search" placeholder="Pesquisar pelo id...">
        <button onclick="fetchData()">Atualizar Lista</button>
        <button onclick="openSendDataPopup()">Enviar Dados</button>
    </div>

    <!-- Cards com informa√ß√µes -->
    <div class="info-card">
        <div class="info-item">
            <i class="fas fa-users" style="color: #3498db;"></i>
            <span class="info-title">N√∫mero do Grupo:</span>
            <span class="info-value">0</span>
        </div>
        <div class="info-item">
            <i class="fas fa-user-shield" style="color: #e74c3c;"></i>
            <span class="info-title">Total de Administradores:</span>
            <span class="info-value">29</span>
        </div>
        <div class="info-item">
            <i class="fas fa-id-badge" style="color: #f39c12;"></i>
            <span class="info-title">√öltimo ID:</span>
            <span class="info-value">100033</span>
        </div>
        <div class="info-item">
            <i class="fas fa-chart-line" style="color: #2ecc71;"></i>
            <span class="info-title">Taxa de Crescimento:</span>
            <span class="info-value">-71.00%</span>
        </div>
        <div class="info-item">
            <i class="fas fa-users-cog" style="color: #9b59b6;"></i>
            <span class="info-title">Faixa Et√°ria Comum:</span>
            <span class="info-value">Jovens (0-18)</span>
        </div>
    </div>

    <div id="data"></div>
</body>
</html>